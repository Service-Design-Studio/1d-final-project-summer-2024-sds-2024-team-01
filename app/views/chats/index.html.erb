<div class="container-fluid chat-container d-flex p-0">
  <div class="sidebar col-3 border-right p-0">
    <h4 class="p-3">Inbox</h4>
    <% if @chats.present? %>
      <% @chats.each do |chat| %>
        <a href="#" class="chat-preview list-group-item list-group-item-action d-flex align-items-center justify-content-between" data-chat-id="<%= chat.id %>">
          <div class="d-flex align-items-center">
            <div class="info">
              <h5 class="mb-1"><%= chat.applicant == current_user ? chat.requester.name : chat.applicant.name %></h5>
              <p class="mb-1"><%= chat.request.title %></p>
            </div>
          </div>
          <div class="d-flex flex-row align-items-end">
            <img src="<%= chat.request.thumbnail %>" alt="Request Image" class="ml-3">
            <div class="time text-right">
              <% if chat.messages.any? %>
                <%= chat.messages.order(created_at: :desc).first.created_at.strftime("%d/%m") %>
              <% else %>
                No messages yet
              <% end %>
            </div>
          </div>
        </a>
      <% end %>
    <% else %>
      <p class="p-3">No chats available.</p>
    <% end %>
  </div>
  <div class="main-chat col-9 p-0" id="main-chat">
    <div class="p-4">
      <p>Select a chat to view the conversation</p>
    </div>
  </div>
</div>

<%= javascript_include_tag 'chats' %>
